!function(e){"use strict";var t=function(){return{restrict:"AE",scope:{ngModel:"=?",highlightDays:"=?",dayClick:"=?",dayHover:"=?",rightClick:"=?",month:"=?",monthChanged:"=?",monthClick:"=?",weekDaysOff:"=?",allDaysOff:"=?",daysAllowed:"=?",sundayFirstDay:"=?",disableNavigation:"=?",disallowBackPastMonths:"=?",disallowGoFuturMonths:"=?",showDaysOfSurroundingMonths:"=?",cssDaysOfSurroundingMonths:"=?",fireEventsForDaysOfSurroundingMonths:"=?",disableDaysBefore:"=?",disableDaysAfter:"=?",changeYearPast:"=?",changeYearFuture:"=?",moment:"=?",year:"=?",showAllYear:"=?"},template:'<div class="multiple-date-picker" layout="row"><div class="monthWrapper" ng-repeat="month in months" flex="30"><div class="picker-top-row"><div class="text-center picker-month">{{month.monthToDisplay}} </div></div><div class="picker-days-week-row"><div class="text-center" ng-repeat="day in daysOfWeek">{{day}}</div></div><div class="picker-days-row"><div class="text-center picker-day {{getDayClasses(day)}}" title="{{day.title}}" ng-repeat="day in month.days" ng-click="toggleDay($event, day)" ng-mouseover="hoverDay($event, day)" ng-mouseleave="dayHover($event, day)" mdp-right-click="rightClicked($event,day)">{{day ? day.mdp.otherMonth && !showDaysOfSurroundingMonths ? \'&nbsp;\' : day.date.format(\'D\') : \'\'}}</div></div></div></div>',link:function(t){var a=window.moment||t.moment;t.ngModel=t.ngModel||[],console.log(t.showAllYear);var n=function(){for(var e=a().localeData()._weekdaysMin,n=[],s=1;s<7;s++)n.push(e[s]);return t.sundayFirstDay?n.splice(0,0,e[0]):n.push(e[0]),n},s=function(){var e=t.month.format("MMMM");return e.charAt(0).toUpperCase()+e.slice(1)},o=function(n){var s=a(n).date(0).day(t.sundayFirstDay?0:1).subtract(1,"day");a(n).date(0).diff(s,"day")>6&&(s=s.add(1,"week"));var o=a(n).date(1),r=[],i=a(),d=a(o).endOf("month"),f=function(){var o={date:a(s.add(1,"day")),mdp:{selected:!1}};if(e.isArray(t.highlightDays)){var r=t.highlightDays.filter(function(e){return o.date.isSame(e.date,"day")});o.css=r.length>0?r[0].css:"",o.title=r.length>0?r[0].title:""}return o.selectable=!t.isDayOff(o),o.mdp.selected=t.isSelected(o),o.mdp.today=o.date.isSame(i,"day"),o.mdp.past=o.date.isBefore(i,"day"),o.mdp.future=o.date.isAfter(i,"day"),o.date.isSame(n,"month")||(o.mdp.otherMonth=!0),o},l=d.diff(s,"days"),c=t.sundayFirstDay?6:0;d.day()!==c&&(l+=(t.sundayFirstDay?6:7)-d.day());for(var y=0;y<l;y++)r.push(f());return r},r=[];r.push(t.$watch("ngModel",function(){t.generate()},!0)),r.push(t.$watch("month",function(){t.generate()},!0)),r.push(t.$watch("highlightDays",function(){t.generate()},!0)),r.push(t.$watch("weekDaysOff",function(){t.generate()},!0)),r.push(t.$watch("allDaysOff",function(){t.generate()},!0)),r.push(t.$watch("daysAllowed",function(){t.generate()},!0)),r.push(t.$watch("disableDaysBefore",function(){t.generate()},!0)),r.push(t.$watch("disableDaysAfter",function(){t.generate()},!0)),r.push(t.$watch(function(){return a.locale()},function(e){t.month.locale(e),t.daysOfWeek=n(),t.monthToDisplay=s()},!0)),t.$on("destroy",function(){for(var e=0;e<r.length;e++)r[e]()}),t.months=[],t.month=t.month||a().startOf("day"),t.days=[],t.weekDaysOff=t.weekDaysOff||[],t.daysOff=t.daysOff||[],t.disableBackButton=!1,t.disableNextButton=!1,t.daysOfWeek=n(),t.cssDaysOfSurroundingMonths=t.cssDaysOfSurroundingMonths||"picker-empty",t.yearsForSelect=[],t.toggleDay=function(e,n){if(e.preventDefault(),!n.mdp.otherMonth||t.fireEventsForDaysOfSurroundingMonths){var s=!1;if(e.preventDefault=function(){s=!0},"function"==typeof t.dayClick&&t.dayClick(e,n),n.selectable&&!s)if(n.mdp.selected=!n.mdp.selected,n.mdp.selected)t.ngModel.push(n.date);else{for(var o=-1,r=0;r<t.ngModel.length;++r)if(a.isMoment(t.ngModel[r])){if(t.ngModel[r].isSame(n.date,"day")){o=r;break}}else if(t.ngModel[r].date.isSame(n.date,"day")){o=r;break}o!==-1&&t.ngModel.splice(o,1)}}},t.hoverDay=function(e,a){e.preventDefault();var n=!1;e.preventDefault=function(){n=!0},"function"==typeof t.dayHover&&t.dayHover(e,a),n||(a.mdp.hover="mouseover"===e.type)},t.rightClicked=function(e,a){"function"==typeof t.rightClick&&(e.preventDefault(),t.rightClick(e,a))},t.getDayClasses=function(e){var a="";return!e.css||e.mdp.otherMonth&&!t.showDaysOfSurroundingMonths||(a+=" "+e.css),t.cssDaysOfSurroundingMonths&&e.mdp.otherMonth&&(a+=" "+t.cssDaysOfSurroundingMonths),e.mdp.selected&&(a+=" picker-selected"),e.selectable||(a+=" picker-off"),e.mdp.today&&(a+=" today"),e.mdp.past&&(a+=" past"),e.mdp.future&&(a+=" future"),e.mdp.otherMonth&&(a+=" picker-other-month"),a},t.changeMonth=function(e,n,s){if(!n){e.preventDefault();var o=!1;e.preventDefault=function(){o=!0};var r=a(t.month).add(s,"month");if("function"==typeof t.monthClick&&t.monthClick(e,r),!o){var i=a(t.month);t.month=r,"function"==typeof t.monthChanged&&t.monthChanged(t.month,i)}}},t.changeYear=function(e){t.month=t.month.year(parseInt(e,10))},t.isDayOff=function(n){return t.allDaysOff||!!t.disableDaysBefore&&a(n.date).isBefore(t.disableDaysBefore,"day")||!!t.disableDaysAfter&&a(n.date).isAfter(t.disableDaysAfter,"day")||e.isArray(t.weekDaysOff)&&t.weekDaysOff.some(function(e){return n.date.day()===e})||e.isArray(t.daysOff)&&t.daysOff.some(function(e){return n.date.isSame(e,"day")})||e.isArray(t.daysAllowed)&&!t.daysAllowed.some(function(e){return n.date.isSame(e,"day")})||e.isArray(t.highlightDays)&&t.highlightDays.some(function(e){return n.date.isSame(e.date,"day")&&!e.selectable})},t.isSelected=function(e){return t.ngModel.some(function(t){return e.date.isSame(t,"day")})},t.generate=function(){a.locale("es"),a().year(t.month.year()),t.months=[];for(var e=0;e<12;e++){var n=a().month(e),s={year:t.month.year().toString(),monthToDisplay:n.format("MMMM"),days:o(n)};t.months.push(s)}},t.generate()}}};e.module("multipleDatePicker",[]).directive("multipleDatePicker",t).directive("mdpRightClick",["$parse",function(e){return function(t,a,n){var s=e(n.mdpRightClick);a.bind("contextmenu",function(e){t.$apply(function(){s(t,{$event:e})})})}}])}(window.angular);