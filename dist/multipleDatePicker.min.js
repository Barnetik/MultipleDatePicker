!function(e){"use strict";var a=function(){return{restrict:"AE",scope:{ngModel:"=?",highlightDays:"=?",dayClick:"=?",dayHover:"=?",rightClick:"=?",month:"=?",monthChanged:"=?",monthClick:"=?",weekDaysOff:"=?",allDaysOff:"=?",daysAllowed:"=?",sundayFirstDay:"=?",disableNavigation:"=?",disallowBackPastMonths:"=?",disallowGoFuturMonths:"=?",showDaysOfSurroundingMonths:"=?",cssDaysOfSurroundingMonths:"=?",fireEventsForDaysOfSurroundingMonths:"=?",disableDaysBefore:"=?",disableDaysAfter:"=?",changeYearPast:"=?",changeYearFuture:"=?",moment:"=?",year:"=?",showAllYear:"=?"},template:'<div class="groupColorPicker" layout="row" layout-sm="column"><div class="color red" ng-class="groupActiveClass(\'red\')" ng-click="changeGroupColor(\'red\')"></div><div class="color green" ng-class="groupActiveClass(\'green\')" ng-click="changeGroupColor(\'green\')"></div><div class="color blue" ng-class="groupActiveClass(\'blue\')" ng-click="changeGroupColor(\'blue\')"></div></div><div class="multiple-date-picker" layout="row" layout-sm="column"><div class="picker-top-row"><div class="text-center picker-navigate picker-navigate-left-arrow" ng-class="{\'disabled\':disableBackButton}" ng-click="changeYear(disableBackButton, -1)">&lt;</div><div class="text-center picker-month"><span>{{year.year()}}</span></div><div class="text-center picker-navigate picker-navigate-right-arrow" ng-class="{\'disabled\':disableNextButton}" ng-click="changeYear(disableNextButton, 1)">&gt;</div></div><div class="monthWrapper" ng-repeat="month in months"><div class="picker-top-row"><div class="text-center picker-month">{{month.monthToDisplay}} </div></div><div class="picker-days-week-row"><div class="text-center" ng-repeat="day in daysOfWeek">{{day}}</div></div><div class="picker-days-row"><div class="text-center picker-day {{day.classes}} current{{currentColorGroup}}" title="{{day.title}}" ng-repeat="day in month.days" ng-click="toggleDay($event, day)" ng-mouseover="hoverDay($event, day)" ng-mouseleave="dayHover($event, day)" mdp-right-click="rightClicked($event,day)">{{day ? day.mdp.otherMonth && !showDaysOfSurroundingMonths ? \'&nbsp;\' : day.date.format(\'D\') : \'\'}}</div></div></div></div>',link:function(a){var t=window.moment||a.moment;a.ngModel=a.ngModel||{red:[],green:[],blue:[]},a.ngModel.red||(a.ngModel.red=[]),a.ngModel.green||(a.ngModel.green=[]),a.ngModel.blue||(a.ngModel.blue=[]);var r=function(){var e=t(),r=t(a.month).subtract(1,"year"),o=t(a.month).add(1,"year"),n=t().add(1,"year");a.previousYear=r.format("YYYY"),a.nextYear=o.format("YYYY"),a.disableBackButton=e.isAfter(r,"year"),a.disableNextButton=n.isBefore(o,"year")},o=function(){t.locale("es");for(var e=t().localeData()._weekdaysMin,r=[],o=1;o<7;o++)r.push(e[o]);return a.sundayFirstDay?r.splice(0,0,e[0]):r.push(e[0]),r},n=function(o){var n=t(o).date(0).day(a.sundayFirstDay?0:1).subtract(1,"day");t(o).date(0).diff(n,"day")>6&&(n=n.add(1,"week"));var s=t(o).date(1),i=[],d=t(),l=t(s).endOf("month"),c=function(){var r={date:t(n.add(1,"day")),mdp:{selected:!1}};if(e.isArray(a.highlightDays)){var s=a.highlightDays.filter(function(e){return r.date.isSame(e.date,"day")});r.css=s.length>0?s[0].css:"",r.title=s.length>0?s[0].title:""}return r.selectable=!a.isDayOff(r),r.mdp.selected=a.isSelected(r),r.mdp.selected&&a.getColorGroup(r),r.mdp.today=r.date.isSame(d,"day"),r.mdp.past=r.date.isBefore(d,"day"),r.mdp.future=r.date.isAfter(d,"day"),r.date.isSame(o,"month")||(r.mdp.otherMonth=!0),r.classes=a.getDayClasses(r),r},u=l.diff(n,"days"),y=a.sundayFirstDay?6:0;l.day()!==y&&(u+=(a.sundayFirstDay?6:7)-l.day());for(var f=0;f<u;f++)i.push(c());return r(),i};a.months=[],a.month=t().startOf("day"),a.year=t().startOf("year"),a.days=[],a.weekDaysOff=a.weekDaysOff||[],a.daysOff=a.daysOff||[],a.disableBackButton=!0,a.disableNextButton=!1,a.daysOfWeek=o(),a.cssDaysOfSurroundingMonths=a.cssDaysOfSurroundingMonths||"picker-empty",a.yearsForSelect=[],a.currentColorGroup="red",a.availableColorGroups=["red","green","blue"],a.toggleDay=function(r,o){if(r.preventDefault(),!o.mdp.otherMonth||a.fireEventsForDaysOfSurroundingMonths){var n=!1;if(r.preventDefault=function(){n=!0},"function"==typeof a.dayClick&&a.dayClick(r,o),o.selectable&&!n){if(o.mdp.selected=!o.mdp.selected,o.mdp.selected)o.mdp.colorGroup=a.currentColorGroup,a.ngModel[a.currentColorGroup].push(o.date);else{var s=-1;e.forEach(a.availableColorGroups,function(e){for(var r=0;r<a.ngModel[e].length;++r)if(t.isMoment(a.ngModel[e][r])){if(a.ngModel[e][r].isSame(o.date,"day")){s=r;break}}else if(o.date.isSame(a.ngModel[e][r],"day")){s=r;break}s!==-1&&a.ngModel[e].splice(s,1)})}o.classes=a.getDayClasses(o)}}},a.hoverDay=function(e,t){e.preventDefault();var r=!1;e.preventDefault=function(){r=!0},"function"==typeof a.dayHover&&a.dayHover(e,t),r||(t.mdp.hover="mouseover"===e.type)},a.changeGroupColor=function(e){a.currentColorGroup=e},a.groupActiveClass=function(e){if(e===a.currentColorGroup)return"active"},a.getColorGroup=function(t){var r=!1;e.forEach(a.availableColorGroups,function(e){if(a.ngModel[e]&&(r=a.ngModel[e].some(function(e){return t.date.isSame(e,"day")})))return void(t.mdp.colorGroup=e)})},a.rightClicked=function(e,t){"function"==typeof a.rightClick&&(e.preventDefault(),a.rightClick(e,t))},a.getDayClasses=function(e){var t="";return!e.css||e.mdp.otherMonth&&!a.showDaysOfSurroundingMonths||(t+=" "+e.css),a.cssDaysOfSurroundingMonths&&e.mdp.otherMonth&&(t+=" "+a.cssDaysOfSurroundingMonths),e.mdp.selected&&(t+=" picker-selected"),e.selectable||(t+=" picker-off"),e.mdp.today&&(t+=" today"),e.mdp.past&&(t+=" past"),e.mdp.future&&(t+=" future"),e.mdp.otherMonth&&(t+=" picker-other-month"),e.mdp.colorGroup&&(t+=" "+e.mdp.colorGroup),t},a.changeYear=function(e,r){if(!e){event.preventDefault();var o=t(a.month).add(r,"year");a.year=o,a.month=o.startOf("month"),a.generate()}},a.changeMonth=function(e,r,o){if(!r){e.preventDefault();var n=!1;e.preventDefault=function(){n=!0};var s=t(a.month).add(o,"month");if("function"==typeof a.monthClick&&a.monthClick(e,s),!n){var i=t(a.month);a.month=s,"function"==typeof a.monthChanged&&a.monthChanged(a.month,i)}}},a.isDayOff=function(r){return a.allDaysOff||!!a.disableDaysBefore&&t(r.date).isBefore(a.disableDaysBefore,"day")||!!a.disableDaysAfter&&t(r.date).isAfter(a.disableDaysAfter,"day")||e.isArray(a.weekDaysOff)&&a.weekDaysOff.some(function(e){return r.date.day()===e})||e.isArray(a.daysOff)&&a.daysOff.some(function(e){return r.date.isSame(e,"day")})||e.isArray(a.daysAllowed)&&!a.daysAllowed.some(function(e){return r.date.isSame(e,"day")})||e.isArray(a.highlightDays)&&a.highlightDays.some(function(e){return r.date.isSame(e.date,"day")&&!e.selectable})},a.isSelected=function(t){var r=!1;return e.forEach(a.availableColorGroups,function(e){r||a.ngModel[e]&&(r=a.ngModel[e].some(function(e){return t.date.isSame(e,"day")}))}),r},a.generate=function(){console.log(a.year),t.locale("es");var e=t().year(a.year.year());a.months=[];for(var o=0;o<12;o++){var s=e.month(o),i={year:e.year().toString(),monthToDisplay:e.format("MMMM"),days:n(s)};a.months.push(i)}console.log("generate called"),r()},a.generate(),a.groupActiveClass()}}};e.module("multipleDatePicker",[]).directive("multipleDatePicker",a).directive("mdpRightClick",["$parse",function(e){return function(a,t,r){var o=e(r.mdpRightClick);t.bind("contextmenu",function(e){a.$apply(function(){o(a,{$event:e})})})}}])}(window.angular);